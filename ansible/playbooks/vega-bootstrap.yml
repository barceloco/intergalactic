---
- name: Bootstrap Vega (create ansible user, disable password auth, set up keys)
  hosts: vega
  become: true
  gather_facts: false
  vars_files:
    - "../inventories/prod/group_vars/all_secrets.yml"
  pre_tasks:
    - name: Import host key verification tasks
      import_tasks: shared/host-key-verification.yml
  roles:
    - common_bootstrap

  post_tasks:
    - name: Display bootstrap completion status
      debug:
        msg: |
          ============================================================================
          âœ“ Phase 1: Bootstrap completed successfully!
          ============================================================================
          The automation user '{{ automation_user }}' has been created and configured.
          
          Next step: Run Phase 2 (Foundation)
          ./scripts/run-ansible.sh prod vega foundation
          ============================================================================
      delegate_to: localhost
      run_once: true
